(self["webpackChunkcpp_book"]=self["webpackChunkcpp_book"]||[]).push([[747],{7747:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=function(){var e=this;e._self._c;return e._m(0)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"box",attrs:{id:"observablehq-viewof-chart-8dfa3deb"}}),t("div",{staticClass:"box",attrs:{id:"observablehq-chartContainer-8dfa3deb"}})])}],i=n(3357),o=n(7783),s={mounted(){(new i.Runtime).module(o["default"],(e=>"chartContainer"===e?new i.Inspector(document.querySelector("#observablehq-chartContainer-8dfa3deb")):"viewof chart"===e?new i.Inspector(document.querySelector("#observablehq-viewof-chart-8dfa3deb")):["chart3","data3"].includes(e)))}},c=s,l=n(1001),u=(0,l.Z)(c,r,a,!1,null,null,null),d=u.exports},7783:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return define}});var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7658),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);function _1(e){return e`## 双图，增加超链接`}function _container(e){const t=e.create("svg").attr("viewBox",[-400,-300,800,700]).property("value","");return t}function _chartContainer(e){return e`
`}function _chart(e,t,n,r,a,i,o,s){const c=e(t(n.hierarchy(r).sort(((e,t)=>n.ascending(e.height,t.height)||n.ascending(e.data.name,t.data.name))))),l=n.create("svg").attr("viewBox",[-400,-300,800,700]).property("value","");l.append("g");l.append("g").attr("font-family","sans-serif").attr("font-size",5).selectAll("g").data(c.leaves()).join("g").attr("transform",(e=>`rotate(${180*e.x/Math.PI-90}) translate(${e.y},0)`)).append("text").attr("dy","0.31em").attr("x",(e=>e.x<Math.PI?6:-6)).attr("text-anchor",(e=>e.x<Math.PI?"start":"end")).attr("transform",(e=>e.x>=Math.PI?"rotate(180)":null)).attr("fill",(e=>e.data.color)).text((e=>e.data.name)).each((function(e){e.text=this})).on("click",d).on("mouseover",f).on("mouseout",h);const u=l.append("g").attr("stroke",a).attr("fill","none").selectAll("path").data(c.leaves().flatMap((e=>e.outgoing))).join("path").style("mix-blend-mode","multiply").attr("d",(([e,t])=>i(e.path(t)))).each((function(e){e.path=this}));function d(e){var t=e.data.url,n=t.split("/").join("");window.open(n,"_blank","resizable,scrollbars,status")}function f(e){u.style("mix-blend-mode",null),n.select(this).attr("font-weight",900).attr("font-size",15),u.attr("stroke","white"),n.selectAll(e.incoming.map((e=>e.path))).attr("stroke",o).raise(),n.selectAll(e.incoming.map((([e])=>e.text))).attr("font-weight",900).attr("font-size",10),n.selectAll(e.outgoing.map((e=>e.path))).attr("stroke",s).raise(),n.selectAll(e.outgoing.map((([,e])=>e.text))).attr("font-weight",900).attr("font-size",10),l.property("value",this).dispatch("input")}function h(e){u.style("mix-blend-mode","multiply"),n.select(this).attr("font-weight",null).attr("font-size",5),u.attr("stroke",a),n.selectAll(e.incoming.map((e=>e.path))).attr("stroke",null),n.selectAll(e.incoming.map((([e])=>e.text))).attr("font-weight",null).attr("font-size",5),n.selectAll(e.outgoing.map((e=>e.path))).attr("stroke",null),n.selectAll(e.outgoing.map((([,e])=>e.text))).attr("font-weight",null).attr("font-size",5),n.select(this).attr("fill",(e=>e.data.color))}return l.node()}function _5(e){return e.__data__["data"]["name"]}async function _data(e,t){return e(await t("my_newflare_xinwangzhan@1.json").json())}function _hierarchy(){return function(e,t="."){let n;const r=new Map;return e.forEach((function e(a){const{name:i}=a;if(r.has(i))return r.get(i);const o=i.lastIndexOf(t);return r.set(i,a),o>=0?(e({name:i.substring(0,o),children:[]}).children.push(a),a.name=i.substring(o+1)):n=a,a})),n}}function _bilink(e){return function(t){const n=new Map(t.leaves().map((t=>[e(t),t])));for(const e of t.leaves())e.incoming=[],e.outgoing=e.data.imports.map((t=>[e,n.get(t)]));for(const e of t.leaves())for(const t of e.outgoing)t[1].incoming.push(t);return t}}function _id(){return function e(t){return`${t.parent?e(t.parent)+".":""}${t.data.name}`}}function _colorin(){return"#00f"}function _colorout(){return"#f00"}function _colornone(){return"#ccc"}function _width(){return 900}function _height(){return 60}function _radius(e){return e/2}function _line(e){return e.lineRadial().curve(e.curveBundle.beta(.85)).radius((e=>e.y)).angle((e=>e.x))}function _tree(e,t){return e.cluster().size([2*Math.PI,t-220])}function _d3(e){return e("d3@5")}function _19(e){return e`### 另一种图`}function _d3_6(e){return e("d3@v6","d3-v6-tip")}function _chart3(e,t,n){return(new e).container(t).svgWidth(975).svgHeight(975).data(n).render()}function _my_newflared_w_color31(e){return e("my_newflare_xinwangzhan@1.json").json()}function _NetworkChart(d3_6){return class NetworkChart{constructor(){const attrs={id:"ID"+Math.floor(1e6*Math.random()),svgWidth:350,svgHeight:350,marginTop:5,marginBottom:5,marginRight:5,marginLeft:5,container:"body",defaultTextFill:"#2C3E50",defaultFont:"Helvetica",duration:500,initialDuration:500,slowDuration:2e3,firstRender:!0,initialLinkColor:"#555",normalCircleRadius:33,rootCircleRadius:50,isTree:!1,transitionEase:d3_6.easeBack,dropShadowId:"drop-shadow-id",onNodeMouseEnter:e=>e,onNodeMouseLeave:e=>e,data:null};this.getState=()=>attrs,this.setState=e=>Object.assign(attrs,e),Object.keys(attrs).forEach((key=>{this[key]||(this[key]=function(_){var string=`attrs['${key}'] = _`;return arguments.length?(eval(string),this):eval(`attrs['${key}'];`)})})),this.initializeEnterExitUpdatePattern()}setAutoBox({svg:e}){const t=e.node(),{x:n,y:r,width:a,height:i}=t.getBBox(),o=[n,r,a,i];e.attr("viewBox",o)}initializeEnterExitUpdatePattern(){d3_6.selection.prototype.patternify=function(e){var t=this,n=e.selector,r=e.tag,a=e.data||[n],i=t.selectAll("."+n).data(a,((e,t)=>"object"===typeof e&&e.id?e.id:t));return i.exit().remove(),i=i.enter().append(r).merge(i),i.attr("class",n),i}}render(){const e=this.getState();return this.setDynamicContainer(e),this.calculateProperties(e),this.createTree(e),this.computeNodeAndLinkData(e),this.drawSvgAndWrappers(e),this.createShadowsAndGradients(),this.drawLinks(e),this.drawNodes(e),this.setAutoBox(e),this.setState({firstRender:!1}),this}setDynamicContainer(){const e=this.getState();var t=d3_6.select(e.container);t.node().getBoundingClientRect();this.setState({container:t})}calculateProperties(){const e=this.getState();var t={id:null,chartTopMargin:null,chartLeftMargin:null,chartWidth:null,chartHeight:null};t.id="ID"+Math.floor(1e6*Math.random()),t.chartLeftMargin=e.marginLeft,t.chartTopMargin=e.marginTop,t.chartWidth=e.svgWidth-e.marginRight-t.chartLeftMargin,t.chartHeight=e.svgHeight-e.marginBottom-t.chartTopMargin,t.radius=t.chartWidth/2,t.centerX=t.chartWidth/2,t.centerY=t.chartHeight/2,e.svgWidth<850&&(this.setState({normalCircleRadius:26}),this.setState({rootCircleRadius:40})),this.setState({calc:t})}computeNodeAndLinkData({root:e}){const t=e.descendants(),n=e.links();this.setState({nodesData:t,linksData:n})}createId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}createShadowsAndGradients(){const{svg:e,dropShadowId:t}=this.getState(),n="#66FCF1",r=.2,a=-30,i=-30,o=400,s=400,c=0,l=0,u=-100,d=-100,f=10.1;var h=e.patternify({tag:"defs",selector:"defs-element"}),p=h.patternify({tag:"filter",selector:"shadow-filter-element"}).attr("id",t).attr("y",`${i}%`).attr("x",`${a}%`).attr("height",`${s}%`).attr("width",`${o}%`);p.patternify({tag:"feGaussianBlur",selector:"feGaussianBlur-element"}).attr("in","SourceAlpha").attr("stdDeviation",f).attr("result","blur"),p.patternify({tag:"feOffset",selector:"feOffset-element"}).attr("in","blur").attr("result","offsetBlur").attr("dx",c).attr("dy",l).attr("x",u).attr("y",d),p.patternify({tag:"feFlood",selector:"feFlood-element"}).attr("in","offsetBlur").attr("flood-color",n).attr("flood-opacity",r).attr("result","offsetColor"),p.patternify({tag:"feComposite",selector:"feComposite-element"}).attr("in","offsetColor").attr("in2","offsetBlur").attr("operator","in").attr("result","offsetBlur");var m=p.patternify({tag:"feMerge",selector:"feMerge-element"});m.patternify({tag:"feMergeNode",selector:"feMergeNode-blur"}).attr("in","offsetBlur"),m.patternify({tag:"feMergeNode",selector:"feMergeNode-graphic"}).attr("in","SourceGraphic")}createTree(){const{data:e,isTree:t,calc:{radius:n}}=this.getState();let r=d3_6.cluster().size([2*Math.PI,n-100]);t&&(r=d3_6.tree().size([2*Math.PI,n-100]).separation(((e,t)=>(e.parent==t.parent?1:3)/e.depth)));const a=r(d3_6.hierarchy(e).sort(((e,t)=>d3_6.ascending(e.data.name,t.data.name))));this.setState({tree:r,root:a})}data(e,t=1){const n=d3_6.hierarchy(e).each((e=>e.data.id=e.data.id||this.createId())).sum((e=>1));return n.each((e=>{e.data.name&&(e.data.name.length>30?e.data._name=`(${e.value-1})</br>`+e.data.name:e.data._name=e.data.name+`</br>(${e.value-1})`,e.value-1==0&&(e.data._name=e.data.name)),e.data.title&&(e.data._name=e.data.title)})),n.each((e=>{e.depth>=t&&(e.data._children=e.data.children,e.data.children=null)})),this.setState({data:e}),this}drawNodes({dropShadowId:e,firstRender:t,transitionEase:n,duration:r,chart:a,tip:i,root:o,nodesWrapper:s,nodesData:c,source:l,rootCircleRadius:u,normalCircleRadius:d,svgWidth:f}){const h=this,p=s.selectAll(".node-wrapper").data(c,(e=>e.data.id||e.data.name)),m=p.enter().append("g").attr("class","node-wrapper").on("mouseenter.tip",(function(e,t){const n=d3_6.select(this).select("circle");(t.data.name||t.data.title).length>27&&i.show(e,t,n.node())})).on("mouseleave.tip",i.hide).on("mouseenter.raise",(function(e){d3_6.select(this).raise()})).on("mouseenter",((e,t)=>this.handleNodeMouseEnter({event:e,d:t,state:this.getState()}))).on("mouseleave",((e,t)=>this.handleNodeMouseLeave({event:e,d:t,state:this.getState()}))).on("click",((e,t)=>{this.handleNodeClick({event:e,d:t,state:this.getState()})}));t&&m.attr("transform",(e=>`\n                  rotate(${180*e.x/Math.PI-90})\n                  translate(${e.y},0)\n                `)),m.each((function(e){d3_6.select(this).append("circle").attr("class","node-circle").attr("fill",(e=>0==e.depth||2==e.depth?"steelblue":1==e.depth?"orange":void 0)).attr("r",(e=>0==e.depth?u:e.data.children||e.data._children?d:10))}));var b=m.merge(p);b.each((function(e){d3_6.select(this).patternify({tag:"foreignObject",selector:"text-fo",data:t=>[e]}).attr("width",(e=>Math.max(2*(d-1),0))).attr("height",(e=>Math.max(62,0))).attr("pointer-events","none").attr("x",(e=>f<850?e.data.children||e.data._children?-d:e.x>=Math.PI?2*-(d-2)-17:16:e.data.children||e.data._children?1-d:e.x>=Math.PI?2*-(d-2)-15:16)).attr("y",(e=>f<850?-d:2-(d-3))).patternify({tag:"xhtml:div",selector:"node-text-div",data:e=>[e].map((e=>{let t=e.x>=Math.PI?"end":"start";return(e.data.children||e.data._children)&&(t="middle"),Object.assign(e,{_textAlign:t})}))}).style("color",(e=>e.data.textFill)).style("font-size","20px").style("text-align","center").style("line-height",1.2).html((e=>`\n                            <div style="color:${e.data.children||e.data._children?"white":"grey"};display: table; width:${Math.max(2*(d-1),0)}px; height: 58px; overflow: hidden;">\n                               <div style="display: table-cell; vertical-align: middle;text-align:${e._textAlign}">\n                                 <div style="opacity:1;${e.data.children||e.data._children?"":"text-overflow: ellipsis;width:65px; white-space: nowrap; overflow: hidden;"}" class="node-name-wrapper">\n                                 ${h.limit(e.data._name||"",e.data.children||e.data._children?f<850?30:40:20)}\n                                 </div>\n                               </div>\n                       </div>`))})),b.select("foreignObject").attr("transform",(e=>` rotate(${180*-e.x/Math.PI+90})`)),b.selectAll(".node-circle").style("filter",null),b.transition().duration(r).ease(n).attr("opacity",1).attr("transform",(e=>`\n          rotate(${180*e.x/Math.PI-90})\n          translate(${e.y},0)\n        `)).on("end",(e=>{b.selectAll(".node-circle").style("filter","url(#drop-shadow-id)")}));p.exit().transition().duration(0).ease(n).attr("opacity",0).attr("transform",(e=>`\n          rotate(${180*e.x/Math.PI-90})\n          translate(${e.y},0)\n        `)).remove().selectAll("circle").attr("r",0);this.setState({svgNodeGroups:a.selectAll(".node-wrapper")})}drawLinks({initialLinkColor:e,transitionEase:t,duration:n,chart:r,root:a,linksWrapper:i,linksData:o,source:s}){const c=i.selectAll("path.link").data(o,(e=>e.target.data.id));var l=c.enter().append("path").attr("class","link").attr("d",(e=>d3_6.linkRadial().angle((e=>e.x)).radius((e=>e.y))({source:e.source,target:e.source})));const u=l.merge(c).attr("fill","none").attr("stroke",e).attr("stroke-opacity",.4).attr("stroke-width",1.5).classed("svg-links",!0).attr("pointer-events","none");u.transition().duration(n).ease(t).attr("opacity",1).attr("d",(e=>d3_6.linkRadial().angle((e=>e.x)).radius((e=>e.y))(e)));c.exit().transition().ease(t).duration(0).attr("d",(e=>d3_6.linkRadial().angle((e=>e.x)).radius((e=>e.y))(e))).remove();this.setState({svgLinks:u})}drawSvgAndWrappers(){const{container:e,svgHeight:t,defaultFont:n,svgWidth:r,calc:a}=this.getState(),{centerX:i,centerY:o}=a,s=e.patternify({tag:"svg",selector:"svg-chart-container"}).style("overflow","visible").attr("preserveAspectRatio","xMidYMid meet").attr("font-family",n);s.patternify({tag:"rect",selector:"boundary-rect"}).attr("width",r).attr("height",t).attr("fill","none");const c=d3_6.tip().offset([-80,0]).attr("class","d3-tip").html(((e,t)=>t.data.name||t.data.title));s.call(c);var l=s.patternify({tag:"g",selector:"inner-wrapper"}).attr("transform","translate("+a.chartLeftMargin+","+a.chartTopMargin+")"),u=l.patternify({tag:"g",selector:"chart"}).attr("transform","translate("+i+","+o+")");const d=u.patternify({tag:"g",selector:"links-wrapper"}),f=u.patternify({tag:"g",selector:"nodes-wrapper"});this.setState({chart:u,svg:s,linksWrapper:d,nodesWrapper:f,tip:c})}handleNodeClick({event:e,d:t,state:{svgCircles:n,svgLinks:r,tip:a,root:i}}){a.hide(),t.eachAfter((e=>{t.data.children&&e.data.children&&t!=e&&(e.data._children=e.data.children,e.data.children=null)})),t.data.children?(t.data._children=t.data.children,t.data.children=null):(t.data.children=t.data._children,t.data._children=null,this.limitMaximumVisibleNodes({max:40,node:t,root:i})),this.setState({source:t}),this.updateTree(this.getState())}handleNodeMouseEnter({event:e,d:t,state:{svgNodeGroups:n,svgLinks:r,onNodeMouseEnter:a}}){a(t);let i=[],o=t.ancestors(),s=t.descendants();i=0==t.depth?o:o.concat(s),r.filter((e=>i.includes(e.target))).raise().attr("stroke","#1493C8").classed("active",!0).attr("stroke-width",5),n.filter((e=>i.includes(e))).classed("active",!0).raise().attr("cursor",(e=>e.data.children||e.data._children?"pointer":Math.round(Math.random())?"no-drop":"copy")).select("circle").attr("fill","#1493C8").transition().duration(500).ease(d3_6.easeElastic).attr("r",(function(e){return e==t?+d3_6.select(this).attr("r")+5:d3_6.select(this).attr("r")}));const c={fill:"white",stroke:"#2E2C2C"};o.map((e=>Object.assign({},c,{text:e.data.name||e.data.title,node:e})))}handleNodeMouseLeave({event:e,d:t,state:{initialLinkColor:n,svgNodeGroups:r,svgLinks:a,normalCircleRadius:i,rootCircleRadius:o,onNodeMouseLeave:s}}){s(t),a.classed("active",!1).attr("stroke",n).attr("stroke-width",1.5),r.classed("active",!1).attr("cursor","auto").select("circle").attr("fill",(e=>0==e.depth||2==e.depth?"steelblue":1==e.depth?"orange":void 0)).transition().ease(d3_6.easeElastic).duration(500).attr("r",(e=>0==e.depth?o:e.data.children||e.data._children?i:10))}limit(e,t){var n="",r=0;return t<e.length&&(n="...",r=3),e=e.slice(0,t-r),e+n}limitMaximumVisibleNodes({max:e,node:t,root:n}){let{slowDuration:r}=this.getState();const a=n.descendants();let i=a.length+(t.data.children||[]).length;if(i>=e){const e=t.ancestors();n.eachAfter((t=>{t.data.children&&!e.includes(t)&&(t.data._children=t.data.children,t.data.children=null)})),this.setState({duration:r})}}updateData(e){this.getChartState();return this}updateTree(){const e=this.getState();this.createTree(e),this.computeNodeAndLinkData(e),this.drawNodes(e),this.drawLinks(e),this.setState({duration:e.initialDuration})}open(e){const t=this.getState();e.ancestors().forEach((t=>{t.data._children&&t!=e&&(t.data.children=t.data._children,t.data._children=null)})),this.createTree(t);const n=t.root.descendants().filter((t=>t.data==e.data))[0];this.limitMaximumVisibleNodes({max:40,node:n,root:t.root}),this.setState({source:t.root}),this.updateTree(this.getState());const r=t.root.descendants().filter((t=>t.data==e.data))[0];this.handleNodeMouseLeave({event:null,d:r,state:this.getState()}),this.handleNodeMouseEnter({event:null,d:r,state:this.getState()})}loopOver(e,t){e.children&&e.children.forEach((e=>{this.loopOver(e,t)})),e._children&&e._children.forEach((e=>{this.loopOver(e,t)})),t(e)}}}function _data3(e,t){return e(t.__data__["data"]["name"])}function _deal_data(e,t){return function(n){var r={name:n,children:[]},a=e(t);for(var i in a[n]){a[a[n][i]].splice(a[a[n][i]].indexOf(n),1);var o=[];for(var s in a[a[n][i]])o.push({name:a[a[n][i]][s]});var c=a[n][i].split("(");r["children"].push({name:c[1].slice(0,-1),children:o})}return r}}function _my_flare(e){return e("my_flare@5.json").json()}function _deepClone1(){return function e(t){var n=Array.isArray(t)?[]:{};if(t&&"object"===typeof t)for(var r in t)t.hasOwnProperty(r)&&(t[r]&&"object"===typeof t[r]?n[r]=e(t[r]):n[r]=t[r]);return n}}function _aaa(){return"U269(KX201)".split("(")}function _29(e){return e[1].slice(0,-1)}function define(e,t){const n=e.module();function r(){return this.url}const a=new Map([["my_newflared_w_color - 2.json",{url:"https://static.observableusercontent.com/files/2c47899a928b038d595eaef2e5a5109fd15afc6437d40890b21626d925af4ed224fb8d74b79ca479ad5e2ffd7f88ef7a679622478d16fc17d2648592a5febc99",mimeType:"application/json",toString:r}],["my_flare@5.json",{url:"https://static.observableusercontent.com/files/e77f7f0f8556bfc95895e26d37e76a2792ec8679fe16e20b151ae01ca6736258b8e13d921c01c397fffbc4241a8ed663dcee473488b7b8795b852dd7cc3e7429",mimeType:"application/json",toString:r}],["my_newflared_w_color - 3@2.json",{url:"https://static.observableusercontent.com/files/03a62b6668ca0af243969c295681a65f504842ff450b55ce0ea25574d43a9077336c5581bf5ddc6645adc5abbf9b9474f040dee65a2a0605ce87e160c3339f89",mimeType:"application/json",toString:r}],["my_newflared_w_color - 3@3.json",{url:"https://static.observableusercontent.com/files/03a62b6668ca0af243969c295681a65f504842ff450b55ce0ea25574d43a9077336c5581bf5ddc6645adc5abbf9b9474f040dee65a2a0605ce87e160c3339f89",mimeType:"application/json",toString:r}],["my_newflared_w_color - 3@4.json",{url:"https://static.observableusercontent.com/files/33e12af65b0d10c9f19ad9ed80678ec7e45f34f2415b4a1914a55dd1d434163449ddda415d7b21ec5874d4a201a0be56cce5cac8d07a7fc5e99bd811bdbcf3e7",mimeType:"application/json",toString:r}],["my_newflared_w_color - 3@5.json",{url:"https://static.observableusercontent.com/files/3ad1f57c4250153f668f981f16ca1b53e41ec34c98d6c3a0b93fa831275b800b763ef28d63ffc0989906c88f6777f904cd28ab82b0f2c67dd85fa7911d18cb1d",mimeType:"application/json",toString:r}],["my_newflare_xinwangzhan.json",{url:"https://static.observableusercontent.com/files/b379a236d3aefe07063edc4da2fe188925f4f4f41373721fdb3903526cfa7315c0b5f099f4f6bef3947f713dd09feb6cb287c01a8edcfc5c348dfe26fbdf85e8",mimeType:"application/json",toString:r}],["my_newflare_xinwangzhan@1.json",{url:"https://static.observableusercontent.com/files/acb15b08f3edd65f0130c9ee4e8d6307ba34f7752a1ec172617618a7ca4597163873370e0d5285f4bbb7bea5c2d30ee9947615bb6c17d6dbd2166081d2771a0d",mimeType:"application/json",toString:r}]]);return n.builtin("FileAttachment",e.fileAttachments((e=>a.get(e)))),n.variable(t()).define(["md"],_1),n.variable(t("container")).define("container",["d3"],_container),n.variable(t("chartContainer")).define("chartContainer",["html"],_chartContainer),n.variable(t("viewof chart")).define("viewof chart",["tree","bilink","d3","data","colornone","line","colorin","colorout"],_chart),n.variable(t("chart")).define("chart",["Generators","viewof chart"],((e,t)=>e.input(t))),n.variable(t()).define(["chart"],_5),n.variable(t("data")).define("data",["hierarchy","FileAttachment"],_data),n.variable(t("hierarchy")).define("hierarchy",_hierarchy),n.variable(t("bilink")).define("bilink",["id"],_bilink),n.variable(t("id")).define("id",_id),n.variable(t("colorin")).define("colorin",_colorin),n.variable(t("colorout")).define("colorout",_colorout),n.variable(t("colornone")).define("colornone",_colornone),n.variable(t("width")).define("width",_width),n.variable(t("height")).define("height",_height),n.variable(t("radius")).define("radius",["width"],_radius),n.variable(t("line")).define("line",["d3"],_line),n.variable(t("tree")).define("tree",["d3","radius"],_tree),n.variable(t("d3")).define("d3",["require"],_d3),n.variable(t()).define(["md"],_19),n.variable(t("d3_6")).define("d3_6",["require"],_d3_6),n.variable(t("chart3")).define("chart3",["NetworkChart","chartContainer","data3"],_chart3),n.variable(t("my_newflared_w_color31")).define("my_newflared_w_color31",["FileAttachment"],_my_newflared_w_color31),n.variable(t("NetworkChart")).define("NetworkChart",["d3_6"],_NetworkChart),n.variable(t("data3")).define("data3",["deal_data","chart"],_data3),n.variable(t("deal_data")).define("deal_data",["deepClone1","my_flare"],_deal_data),n.variable(t("my_flare")).define("my_flare",["FileAttachment"],_my_flare),n.variable(t("deepClone1")).define("deepClone1",_deepClone1),n.variable(t("aaa")).define("aaa",_aaa),n.variable(t()).define(["aaa"],_29),n}},3357:function(e,t,n){"use strict";n.r(t),n.d(t,{Inspector:function(){return de},Library:function(){return tr},Runtime:function(){return xr},RuntimeError:function(){return rr}});n(3767),n(8585),n(8696),n(7658),n(4633);function r(e,t,n){n=n||{};var r=e.ownerDocument,a=r.defaultView.CustomEvent;"function"==typeof a?a=new a(t,{detail:n}):((a=r.createEvent("Event")).initEvent(t,!1,!1),a.detail=n),e.dispatchEvent(a)}function a(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function i(e){return e===(0|e)+""}function o(e){const t=document.createElement("span");return t.className="observablehq--cellname",t.textContent=`${e} = `,t}const s=Symbol.prototype.toString;function c(e){return s.call(e)}const{getOwnPropertySymbols:l,prototype:{hasOwnProperty:u}}=Object,{toStringTag:d}=Symbol,f={},h=l;function p(e,t){return u.call(e,t)}function m(e){return e[d]||e.constructor&&e.constructor.name||"Object"}function b(e,t){try{const n=e[t];return n&&n.constructor,n}catch(e){return f}}const v=[{symbol:"@@__IMMUTABLE_INDEXED__@@",name:"Indexed",modifier:!0},{symbol:"@@__IMMUTABLE_KEYED__@@",name:"Keyed",modifier:!0},{symbol:"@@__IMMUTABLE_LIST__@@",name:"List",arrayish:!0},{symbol:"@@__IMMUTABLE_MAP__@@",name:"Map"},{symbol:"@@__IMMUTABLE_ORDERED__@@",name:"Ordered",modifier:!0,prefix:!0},{symbol:"@@__IMMUTABLE_RECORD__@@",name:"Record"},{symbol:"@@__IMMUTABLE_SET__@@",name:"Set",arrayish:!0,setish:!0},{symbol:"@@__IMMUTABLE_STACK__@@",name:"Stack",arrayish:!0}];function w(e){try{let t=v.filter((({symbol:t})=>!0===e[t]));if(!t.length)return;const n=t.find((e=>!e.modifier)),r="Map"===n.name&&t.find((e=>e.modifier&&e.prefix)),a=t.some((e=>e.arrayish)),i=t.some((e=>e.setish));return{name:`${r?r.name:""}${n.name}`,symbols:t,arrayish:a&&!i,setish:i}}catch(e){return null}}const{getPrototypeOf:y,getOwnPropertyDescriptors:_}=Object,g=y({});function E(e,t,n,i){let s,c,l,u,d=a(e);e instanceof Map?e instanceof e.constructor?(s=`Map(${e.size})`,c=x):(s="Map()",c=S):e instanceof Set?e instanceof e.constructor?(s=`Set(${e.size})`,c=C):(s="Set()",c=S):d?(s=`${e.constructor.name}(${e.length})`,c=A):(u=w(e))?(s=`Immutable.${u.name}${"Record"===u.name?"":`(${e.size})`}`,d=u.arrayish,c=u.arrayish?k:u.setish?N:j):i?(s=m(e),c=T):(s=m(e),c=S);const f=document.createElement("span");f.className="observablehq--expanded",n&&f.appendChild(o(n));const h=f.appendChild(document.createElement("a"));h.innerHTML="<svg width=8 height=8 class='observablehq--caret'>\n    <path d='M4 7L0 1h8z' fill='currentColor' />\n  </svg>",h.appendChild(document.createTextNode(`${s}${d?" [":" {"}`)),h.addEventListener("mouseup",(function(t){t.stopPropagation(),le(f,I(e,null,n,i))})),c=c(e);for(let r=0;!(l=c.next()).done&&r<20;++r)f.appendChild(l.value);if(!l.done){const e=f.appendChild(document.createElement("a"));e.className="observablehq--field",e.style.display="block",e.appendChild(document.createTextNode("  … more")),e.addEventListener("mouseup",(function(e){e.stopPropagation(),f.insertBefore(l.value,f.lastChild.previousSibling);for(let t=0;!(l=c.next()).done&&t<19;++t)f.insertBefore(l.value,f.lastChild.previousSibling);l.done&&f.removeChild(f.lastChild.previousSibling),r(f,"load")}))}return f.appendChild(document.createTextNode(d?"]":"}")),f}function*x(e){for(const[t,n]of e)yield O(t,n);yield*S(e)}function*C(e){for(const t of e)yield q(t);yield*S(e)}function*N(e){for(const t of e)yield q(t)}function*A(e){for(let t=0,n=e.length;t<n;++t)t in e&&(yield $(t,b(e,t),"observablehq--index"));for(const t in e)!i(t)&&p(e,t)&&(yield $(t,b(e,t),"observablehq--key"));for(const t of h(e))yield $(c(t),b(e,t),"observablehq--symbol")}function*k(e){let t=0;for(const n=e.size;t<n;++t)yield $(t,e.get(t),!0)}function*T(e){for(const n in _(e))yield $(n,b(e,n),"observablehq--key");for(const n of h(e))yield $(c(n),b(e,n),"observablehq--symbol");const t=y(e);t&&t!==g&&(yield M(t))}function*S(e){for(const n in e)p(e,n)&&(yield $(n,b(e,n),"observablehq--key"));for(const n of h(e))yield $(c(n),b(e,n),"observablehq--symbol");const t=y(e);t&&t!==g&&(yield M(t))}function*j(e){for(const[t,n]of e)yield $(t,n,"observablehq--key")}function M(e){const t=document.createElement("div"),n=t.appendChild(document.createElement("span"));return t.className="observablehq--field",n.className="observablehq--prototype-key",n.textContent="  <prototype>",t.appendChild(document.createTextNode(": ")),t.appendChild(ce(e,void 0,void 0,void 0,!0)),t}function $(e,t,n){const r=document.createElement("div"),a=r.appendChild(document.createElement("span"));return r.className="observablehq--field",a.className=n,a.textContent=`  ${e}`,r.appendChild(document.createTextNode(": ")),r.appendChild(ce(t)),r}function O(e,t){const n=document.createElement("div");return n.className="observablehq--field",n.appendChild(document.createTextNode("  ")),n.appendChild(ce(e)),n.appendChild(document.createTextNode(" => ")),n.appendChild(ce(t)),n}function q(e){const t=document.createElement("div");return t.className="observablehq--field",t.appendChild(document.createTextNode("  ")),t.appendChild(ce(e)),t}function L(e){const t=window.getSelection();return"Range"===t.type&&(t.containsNode(e,!0)||t.anchorNode.isSelfOrDescendant(e)||t.focusNode.isSelfOrDescendant(e))}function I(e,t,n,r){let i,s,c,l,u=a(e);if(e instanceof Map?e instanceof e.constructor?(i=`Map(${e.size})`,s=P):(i="Map()",s=F):e instanceof Set?e instanceof e.constructor?(i=`Set(${e.size})`,s=R):(i="Set()",s=F):u?(i=`${e.constructor.name}(${e.length})`,s=B):(l=w(e))?(i=`Immutable.${l.name}${"Record"===l.name?"":`(${e.size})`}`,u=l.arrayish,s=l.arrayish?U:l.setish?D:z):(i=m(e),s=F),t){const t=document.createElement("span");return t.className="observablehq--shallow",n&&t.appendChild(o(n)),t.appendChild(document.createTextNode(i)),t.addEventListener("mouseup",(function(n){L(t)||(n.stopPropagation(),le(t,I(e)))})),t}const d=document.createElement("span");d.className="observablehq--collapsed",n&&d.appendChild(o(n));const f=d.appendChild(document.createElement("a"));f.innerHTML="<svg width=8 height=8 class='observablehq--caret'>\n    <path d='M7 4L1 8V0z' fill='currentColor' />\n  </svg>",f.appendChild(document.createTextNode(`${i}${u?" [":" {"}`)),d.addEventListener("mouseup",(function(t){L(d)||(t.stopPropagation(),le(d,E(e,0,n,r)))}),!0),s=s(e);for(let a=0;!(c=s.next()).done&&a<20;++a)a>0&&d.appendChild(document.createTextNode(", ")),d.appendChild(c.value);return c.done||d.appendChild(document.createTextNode(", …")),d.appendChild(document.createTextNode(u?"]":"}")),d}function*P(e){for(const[t,n]of e)yield G(t,n);yield*F(e)}function*R(e){for(const t of e)yield ce(t,!0);yield*F(e)}function*D(e){for(const t of e)yield ce(t,!0)}function*U(e){let t=-1,n=0;for(const r=e.size;n<r;++n)n>t+1&&(yield W(n-t-1)),yield ce(e.get(n),!0),t=n;n>t+1&&(yield W(n-t-1))}function*B(e){let t=-1,n=0;for(const r=e.length;n<r;++n)n in e&&(n>t+1&&(yield W(n-t-1)),yield ce(b(e,n),!0),t=n);n>t+1&&(yield W(n-t-1));for(const r in e)!i(r)&&p(e,r)&&(yield H(r,b(e,r),"observablehq--key"));for(const r of h(e))yield H(c(r),b(e,r),"observablehq--symbol")}function*F(e){for(const t in e)p(e,t)&&(yield H(t,b(e,t),"observablehq--key"));for(const t of h(e))yield H(c(t),b(e,t),"observablehq--symbol")}function*z(e){for(const[t,n]of e)yield H(t,n,"observablehq--key")}function W(e){const t=document.createElement("span");return t.className="observablehq--empty",t.textContent=1===e?"empty":`empty × ${e}`,t}function H(e,t,n){const r=document.createDocumentFragment(),a=r.appendChild(document.createElement("span"));return a.className=n,a.textContent=e,r.appendChild(document.createTextNode(": ")),r.appendChild(ce(t,!0)),r}function G(e,t){const n=document.createDocumentFragment();return n.appendChild(ce(e,!0)),n.appendChild(document.createTextNode(" => ")),n.appendChild(ce(t,!0)),n}function V(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return"function"==typeof t?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),a=e.getUTCSeconds(),i=e.getUTCMilliseconds();return`${o=e.getUTCFullYear(),o<0?`-${Y(-o,6)}`:o>9999?`+${Y(o,6)}`:Y(o,4)}-${Y(e.getUTCMonth()+1,2)}-${Y(e.getUTCDate(),2)}${n||r||a||i?`T${Y(n,2)}:${Y(r,2)}${a||i?`:${Y(a,2)}${i?`.${Y(i,3)}`:""}`:""}Z`:""}`;var o}function Y(e,t){return`${e}`.padStart(t,"0")}var Z=Error.prototype.toString,K=RegExp.prototype.toString;function X(e){return e.replace(/[\\`\x00-\x09\x0b-\x19]|\${/g,J)}function J(e){var t=e.charCodeAt(0);switch(t){case 8:return"\\b";case 9:return"\\t";case 11:return"\\v";case 12:return"\\f";case 13:return"\\r"}return t<16?"\\x0"+t.toString(16):t<32?"\\x"+t.toString(16):"\\"+e}function Q(e,t){for(var n=0;t.exec(e);)++n;return n}var ee=Function.prototype.toString,te={prefix:"async ƒ"},ne={prefix:"async ƒ*"},re={prefix:"class"},ae={prefix:"ƒ"},ie={prefix:"ƒ*"};function oe(e,t,n){var r=document.createElement("span");r.className="observablehq--function",n&&r.appendChild(o(n));var a=r.appendChild(document.createElement("span"));return a.className="observablehq--keyword",a.textContent=e.prefix,r.appendChild(document.createTextNode(t)),r}const{prototype:{toString:se}}=Object;function ce(e,t,n,r,a){let i=typeof e;switch(i){case"boolean":case"undefined":e+="";break;case"number":e=0===e&&1/e<0?"-0":e+"";break;case"bigint":e+="n";break;case"symbol":e=c(e);break;case"function":return function(e,t){var n,r,a=ee.call(e);switch(e.constructor&&e.constructor.name){case"AsyncFunction":n=te;break;case"AsyncGeneratorFunction":n=ne;break;case"GeneratorFunction":n=ie;break;default:n=/^class\b/.test(a)?re:ae}return n===re?oe(n,"",t):(r=/^(?:async\s*)?(\w+)\s*=>/.exec(a))?oe(n,"("+r[1]+")",t):(r=/^(?:async\s*)?\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(a))||(r=/^(?:async\s*)?function(?:\s*\*)?(?:\s*\w+)?\s*\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(a))?oe(n,r[1]?"("+r[1].replace(/\s*,\s*/g,", ")+")":"()",t):oe(n,"(…)",t)}(e,r);case"string":return function(e,t,n,r){if(!1===t){if(Q(e,/["\n]/g)<=Q(e,/`|\${/g)){const t=document.createElement("span");r&&t.appendChild(o(r));const n=t.appendChild(document.createElement("span"));return n.className="observablehq--string",n.textContent=JSON.stringify(e),t}const a=e.split("\n");if(a.length>20&&!n){const n=document.createElement("div");r&&n.appendChild(o(r));const i=n.appendChild(document.createElement("span"));i.className="observablehq--string",i.textContent="`"+X(a.slice(0,20).join("\n"));const s=n.appendChild(document.createElement("span")),c=a.length-20;return s.textContent=`Show ${c} truncated line${c>1?"s":""}`,s.className="observablehq--string-expand",s.addEventListener("mouseup",(function(a){a.stopPropagation(),le(n,ce(e,t,!0,r))})),n}const i=document.createElement("span");r&&i.appendChild(o(r));const s=i.appendChild(document.createElement("span"));return s.className="observablehq--string"+(n?" observablehq--expanded":""),s.textContent="`"+X(e)+"`",i}const a=document.createElement("span");r&&a.appendChild(o(r));const i=a.appendChild(document.createElement("span"));return i.className="observablehq--string",i.textContent=JSON.stringify(e.length>100?`${e.slice(0,50)}…${e.slice(-49)}`:e),a}(e,t,n,r);default:if(null===e){i=null,e="null";break}if(e instanceof Date){i="date",e=V(e,"Invalid Date");break}if(e===f){i="forbidden",e="[forbidden]";break}switch(se.call(e)){case"[object RegExp]":i="regexp",e=function(e){return K.call(e)}(e);break;case"[object Error]":case"[object DOMException]":i="error",e=function(e){return e.stack||Z.call(e)}(e);break;default:return(n?E:I)(e,t,r,a)}}const s=document.createElement("span");r&&s.appendChild(o(r));const l=s.appendChild(document.createElement("span"));return l.className=`observablehq--${i}`,l.textContent=e,s}function le(e,t){e.classList.contains("observablehq--inspect")&&t.classList.add("observablehq--inspect"),e.parentNode.replaceChild(t,e),r(t,"load")}const ue=/\s+\(\d+:\d+\)$/m;class de{constructor(e){if(!e)throw new Error("invalid node");this._node=e,e.classList.add("observablehq")}pending(){const{_node:e}=this;e.classList.remove("observablehq--error"),e.classList.add("observablehq--running")}fulfilled(e,t){const{_node:n}=this;if((!function(e){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor}(e)||e.parentNode&&e.parentNode!==n)&&(e=ce(e,!1,n.firstChild&&n.firstChild.classList&&n.firstChild.classList.contains("observablehq--expanded"),t)).classList.add("observablehq--inspect"),n.classList.remove("observablehq--running","observablehq--error"),n.firstChild!==e)if(n.firstChild){for(;n.lastChild!==n.firstChild;)n.removeChild(n.lastChild);n.replaceChild(e,n.firstChild)}else n.appendChild(e);r(n,"update")}rejected(e,t){const{_node:n}=this;for(n.classList.remove("observablehq--running"),n.classList.add("observablehq--error");n.lastChild;)n.removeChild(n.lastChild);var a=document.createElement("div");a.className="observablehq--inspect",t&&a.appendChild(o(t)),a.appendChild(document.createTextNode((e+"").replace(ue,""))),n.appendChild(a),r(n,"error",{error:e})}}de.into=function(e){if("string"==typeof e&&null==(e=document.querySelector(e)))throw new Error("container not found");return function(){return new de(e.appendChild(document.createElement("div")))}};var fe={},he={};function pe(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function me(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function be(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function ve(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),a=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+be(-t,6):t>9999?"+"+be(t,6):be(t,4))+"-"+be(e.getUTCMonth()+1,2)+"-"+be(e.getUTCDate(),2)+(i?"T"+be(n,2)+":"+be(r,2)+":"+be(a,2)+"."+be(i,3)+"Z":a?"T"+be(n,2)+":"+be(r,2)+":"+be(a,2)+"Z":r||n?"T"+be(n,2)+":"+be(r,2)+"Z":"")}function we(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,s=0,c=i<=0,l=!1;function u(){if(c)return he;if(l)return l=!1,fe;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?c=!0:10===(r=e.charCodeAt(o++))?l=!0:13===r&&(l=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))l=!0;else if(13===r)l=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return c=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=u())!==he;){for(var d=[];r!==fe&&r!==he;)d.push(r),r=u();t&&null==(d=t(d,s++))||a.push(d)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?ve(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=pe(e);return function(r,a){return t(n(r),a,e)}}(e,t):pe(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=me(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=me(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}}var ye=we(","),_e=ye.parse,ge=ye.parseRows,Ee=we("\t"),xe=Ee.parse,Ce=Ee.parseRows;function Ne(e){for(var t in e){var n,r,a=e[t].trim();if(a)if("true"===a)a=!0;else if("false"===a)a=!1;else if("NaN"===a)a=NaN;else if(isNaN(n=+a)){if(!(r=a.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Ae&&r[4]&&!r[7]&&(a=a.replace(/-/g,"/").replace(/T/," ")),a=new Date(a)}else a=n;else a=null;e[t]=a}return e}const Ae=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function ke(e,t,n){return{resolve:(r=n)=>`${e}@${t}/${r}`}}const Te=ke("d3","7.8.4","dist/d3.min.js"),Se=ke("@observablehq/inputs","0.10.4","dist/inputs.min.js"),je=ke("@observablehq/plot","0.6.6","dist/plot.umd.min.js"),Me=ke("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),$e=ke("@observablehq/highlight.js","2.0.0","highlight.min.js"),Oe=ke("@observablehq/katex","0.11.1","dist/katex.min.js"),qe=ke("lodash","4.17.21","lodash.min.js"),Le=ke("htl","0.3.1","dist/htl.min.js"),Ie=ke("jszip","3.10.1","dist/jszip.min.js"),Pe=ke("marked","0.3.12","marked.min.js"),Re=ke("sql.js","1.8.0","dist/sql-wasm.js"),De=ke("vega","5.22.1","build/vega.min.js"),Ue=ke("vega-lite","5.6.0","build/vega-lite.min.js"),Be=ke("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),Fe=ke("apache-arrow","4.0.1","Arrow.es2015.min.js"),ze=ke("apache-arrow","9.0.0","+esm"),We=ke("apache-arrow","11.0.0","+esm"),He=ke("arquero","4.8.8","dist/arquero.min.js"),Ge=ke("topojson-client","3.1.0","dist/topojson-client.min.js"),Ve=ke("exceljs","4.3.0","dist/exceljs.min.js"),Ye=ke("mermaid","9.2.2","dist/mermaid.min.js"),Ze=ke("leaflet","1.9.3","dist/leaflet.js"),Ke=ke("@duckdb/duckdb-wasm","1.24.0","+esm"),Xe=new Map,Je=[],Qe=Je.map,et=Je.some,tt=Je.hasOwnProperty,nt=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,rt=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,at=/(?:\.[^/]*|\/)$/;class it extends Error{constructor(e){super(e)}}function ot(e){const t=nt.exec(e);return t&&{name:t[1],version:t[2],path:t[3]}}function st(e="https://cdn.jsdelivr.net/npm/",t=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(e))throw new Error("origin lacks trailing slash");function n(t){const n=`${e}${t.name}${t.version?`@${t.version}`:""}/package.json`;let r=Xe.get(n);return r||Xe.set(n,r=fetch(n).then((e=>{if(!e.ok)throw new it("unable to load package.json");return e.redirected&&!Xe.has(e.url)&&Xe.set(e.url,r),e.json()}))),r}return async function(r,a){if(r.startsWith(e)&&(r=r.substring(e.length)),/^(\w+:)|\/\//i.test(r))return r;if(/^[.]{0,2}\//i.test(r))return new URL(r,null==a?location:a).href;if(!r.length||/^[\s._]/.test(r)||/\s$/.test(r))throw new it("illegal name");const i=ot(r);if(!i)return`${e}${r}`;if(!i.version&&null!=a&&a.startsWith(e)){const t=await n(ot(a.substring(e.length)));i.version=t.dependencies&&t.dependencies[i.name]||t.peerDependencies&&t.peerDependencies[i.name]}if(i.path&&!at.test(i.path)&&(i.path+=".js"),i.path&&i.version&&rt.test(i.version))return`${e}${i.name}@${i.version}/${i.path}`;const o=await n(i);return`${e}${o.name}@${o.version}/${i.path||function(e){for(const n of t){let t=e[n];if("string"==typeof t)return t.startsWith("./")&&(t=t.slice(2)),at.test(t)?t:`${t}.js`}}(o)||"index.js"}`}}it.prototype.name=it.name;var ct=lt(st());function lt(e){const t=new Map,n=a(null);function r(e){if("string"!=typeof e)return e;let n=t.get(e);return n||t.set(e,n=new Promise(((t,n)=>{const r=document.createElement("script");r.onload=()=>{try{t(Je.pop()(a(e)))}catch(e){n(new it("invalid module"))}r.remove()},r.onerror=()=>{n(new it("unable to load module")),r.remove()},r.async=!0,r.src=e,window.define=ht,document.head.appendChild(r)}))),n}function a(t){return n=>Promise.resolve(e(n,t)).then(r)}function i(e){return arguments.length>1?Promise.all(Qe.call(arguments,n)).then(ut):n(e)}return i.alias=function(t){return lt(((n,r)=>n in t&&(r=null,"string"!=typeof(n=t[n]))?n:e(n,r)))},i.resolve=e,i}function ut(e){const t={};for(const n of e)for(const e in n)tt.call(n,e)&&(null==n[e]?Object.defineProperty(t,e,{get:dt(n,e)}):t[e]=n[e]);return t}function dt(e,t){return()=>e[t]}function ft(e){return"exports"===(e+="")||"module"===e}function ht(e,t,n){const r=arguments.length;r<2?(n=e,t=[]):r<3&&(n=t,t="string"==typeof e?[]:e),Je.push(et.call(t,ft)?e=>{const r={},a={exports:r};return Promise.all(Qe.call(t,(t=>"exports"===(t+="")?r:"module"===t?a:e(t)))).then((e=>(n.apply(null,e),a.exports)))}:e=>Promise.all(Qe.call(t,e)).then((e=>"function"==typeof n?n.apply(null,e):n)))}ht.amd={};const pt="https://cdn.observableusercontent.com/npm/";let mt,bt=ct;async function vt(e){const[t,n]=await Promise.all([e(Re.resolve()),e.resolve(Re.resolve("dist/"))]);return t({locateFile:e=>`${n}${e}`})}class wt{constructor(e){Object.defineProperties(this,{_db:{value:e}})}static async open(e){const[t,n]=await Promise.all([vt(bt),Promise.resolve(e).then(_t)]);return new wt(new t.Database(n))}async query(e,t){return await async function(e,t,n){const[r]=await e.exec(t,n);if(!r)return[];const{columns:a,values:i}=r,o=i.map((e=>Object.fromEntries(e.map(((e,t)=>[a[t],e])))));return o.columns=a,o}(this._db,e,t)}async queryRow(e,t){return(await this.query(e,t))[0]||null}async explain(e,t){return gt("pre",{className:"observablehq--inspect"},[Et((await this.query(`EXPLAIN QUERY PLAN ${e}`,t)).map((e=>e.detail)).join("\n"))])}async describeTables({schema:e}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${null==e?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%' ORDER BY schema, name`,null==e?[]:[e])}async describeColumns({schema:e,table:t}={}){if(null==t)throw new Error("missing table");const n=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${null==e?"":", ?"}) ORDER BY cid`,null==e?[t]:[t,e]);if(!n.length)throw new Error(`table not found: ${t}`);return n.map((({name:e,type:t,notnull:n})=>({name:e,type:yt(t),databaseType:t,nullable:!n})))}async describe(e){const t=await(void 0===e?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[e]));if(!t.length)throw new Error("Not found");const{columns:n}=t;return gt("table",{value:t},[gt("thead",[gt("tr",n.map((e=>gt("th",[Et(e)]))))]),gt("tbody",t.map((e=>gt("tr",n.map((t=>gt("td",[Et(e[t])])))))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(e,...t){return[e.join("?"),t]}}function yt(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":case"DATE":case"DATETIME":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function _t(e){return"string"==typeof e?fetch(e).then(_t):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(_t):e instanceof ArrayBuffer?new Uint8Array(e):e}function gt(e,t,n){2===arguments.length&&(n=t,t=void 0);const r=document.createElement(e);if(void 0!==t)for(const a in t)r[a]=t[a];if(void 0!==n)for(const a of n)r.appendChild(a);return r}function Et(e){return document.createTextNode(e)}function xt(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ct(e,t=xt){let n,r=!1;if(1===t.length){let a;for(const i of e){const e=t(i);(r?xt(e,a)>0:0===xt(e,e))&&(n=i,a=e,r=!0)}}else for(const a of e)(r?t(a,n)>0:0===t(a,a))&&(n=a,r=!0);return n}function Nt(e){return e&&"function"==typeof e.toArrowBuffer}function At(e){return e&&"function"==typeof e.getChild&&"function"==typeof e.toArray&&e.schema&&Array.isArray(e.schema.fields)}function kt(e){return{name:e.name,type:Tt(e.type),nullable:e.nullable,databaseType:String(e.type)}}function Tt(e){switch(e.typeId){case 2:return"integer";case 3:case 7:return"number";case 4:case 15:return"buffer";case 5:return"string";case 6:return"boolean";case 8:case 9:case 10:return"date";case 12:case 16:return"array";case 13:case 14:return"object";default:return"other"}}async function St(){return await n(7512)(`${pt}${We.resolve()}`)}Object.defineProperty(wt.prototype,"dialect",{value:"sqlite"});class jt{constructor(e){Object.defineProperties(this,{_db:{value:e}})}async queryStream(e,t){const n=await this._db.connect();let r,a;try{if(t?.length>0){const a=await n.prepare(e);r=await a.send(...t)}else r=await n.send(e);if(a=await r.next(),a.done)throw new Error("missing first batch")}catch(e){throw await n.close(),e}return{schema:(i=a.value,i.schema.fields.map(kt)),async*readRows(){try{for(;!a.done;)yield a.value.toArray(),a=await r.next()}finally{await n.close()}}};var i}async query(e,t){const n=await this.queryStream(e,t),r=[];for await(const a of n.readRows())for(const e of a)r.push(e);return r.schema=n.schema,r}async queryRow(e,t){const n=(await this.queryStream(e,t)).readRows();try{const{done:e,value:t}=await n.next();return e||!t.length?null:t[0]}finally{await n.return()}}async sql(e,...t){return await this.query(e.join("?"),t)}queryTag(e,...t){return[e.join("?"),t]}escape(e){return`"${e}"`}async describeTables(){return(await this.query("SHOW TABLES")).map((({name:e})=>({name:e})))}async describeColumns({table:e}={}){return(await this.query(`DESCRIBE ${this.escape(e)}`)).map((({column_name:e,column_type:t,null:n})=>({name:e,type:qt(t),nullable:"NO"!==n,databaseType:t})))}static async of(e={},t={}){const r=await async function(){void 0===mt&&(mt=async function(){const e=await n(7512)(`${pt}${Ke.resolve()}`),t=await e.selectBundle({mvp:{mainModule:`${pt}${Ke.resolve("dist/duckdb-mvp.wasm")}`,mainWorker:`${pt}${Ke.resolve("dist/duckdb-browser-mvp.worker.js")}`},eh:{mainModule:`${pt}${Ke.resolve("dist/duckdb-eh.wasm")}`,mainWorker:`${pt}${Ke.resolve("dist/duckdb-browser-eh.worker.js")}`}}),r=new e.ConsoleLogger;return{module:e,bundle:t,logger:r}}());const{module:e,bundle:t,logger:r}=await mt,a=await e.createWorker(t.mainWorker),i=new e.AsyncDuckDB(r,a);return await i.instantiate(t.mainModule),i}();return void 0===t.query?.castTimestampToDate&&(t={...t,query:{...t.query,castTimestampToDate:!0}}),void 0===t.query?.castBigIntToDouble&&(t={...t,query:{...t.query,castBigIntToDouble:!0}}),await r.open(t),await Promise.all(Object.entries(e).map((async([e,t])=>{if(t instanceof Tn)await Mt(r,e,t);else if(At(t))await $t(r,e,t);else if(Array.isArray(t))await Ot(r,e,t);else if(Nt(t))await async function(e,t,n){const r=(await St()).tableFromIPC(n.toArrowBuffer());return await $t(e,t,r)}(r,e,t);else if("data"in t){const{data:n,...a}=t;At(n)?await $t(r,e,n,a):await Ot(r,e,n,a)}else{if(!("file"in t))throw new Error(`invalid source: ${t}`);{const{file:n,...a}=t;await Mt(r,e,n,a)}}}))),new jt(r)}}async function Mt(e,t,n,r){const a=await n.url();if(a.startsWith("blob:")){const t=await n.arrayBuffer();await e.registerFileBuffer(n.name,new Uint8Array(t))}else await e.registerFileURL(n.name,a,4);const i=await e.connect();try{switch(n.mimeType){case"text/csv":case"text/tab-separated-values":return await i.insertCSVFromPath(n.name,{name:t,schema:"main",...r}).catch((async e=>{if(e.toString().includes("Could not convert"))return await async function(e,t,n){const r=await e.prepare(`CREATE TABLE '${n}' AS SELECT * FROM read_csv_auto(?, ALL_VARCHAR=TRUE)`);return await r.send(t.name)}(i,n,t);throw e}));case"application/json":return await i.insertJSONFromPath(n.name,{name:t,schema:"main",...r});default:if(/\.arrow$/i.test(n.name)){const e=new Uint8Array(await n.arrayBuffer());return await i.insertArrowFromIPCStream(e,{name:t,schema:"main",...r})}if(/\.parquet$/i.test(n.name))return await i.query(`CREATE VIEW '${t}' AS SELECT * FROM parquet_scan('${n.name}')`);throw new Error(`unknown file type: ${n.mimeType}`)}}finally{await i.close()}}async function $t(e,t,n,r){const a=await e.connect();try{await a.insertArrowTable(n,{name:t,schema:"main",...r})}finally{await a.close()}}async function Ot(e,t,n,r){const a=(await St()).tableFromJSON(n);return await $t(e,t,a,r)}function qt(e){switch(e){case"BIGINT":case"HUGEINT":case"UBIGINT":return"bigint";case"DOUBLE":case"REAL":case"FLOAT":return"number";case"INTEGER":case"SMALLINT":case"TINYINT":case"USMALLINT":case"UINTEGER":case"UTINYINT":return"integer";case"BOOLEAN":return"boolean";case"DATE":case"TIMESTAMP":case"TIMESTAMP WITH TIME ZONE":return"date";case"VARCHAR":case"UUID":return"string";default:return/^DECIMAL\(/.test(e)?"integer":"other"}}function Lt(e){return Array.isArray(e)&&(It(e.schema)||Pt(e.columns)||function(e){const t=Math.min(20,e.length);for(let n=0;n<t;++n){const t=e[n];if(null===t||"object"!=typeof t)return!1}return t>0&&function(e){for(const t in e)return!0;return!1}(e[0])}(e)||Ut(e)||Bt(e))||Ft(e)}function It(e){return Array.isArray(e)&&e.every(Rt)}function Pt(e){return Array.isArray(e)&&e.every((e=>"string"==typeof e))}function Rt(e){return e&&"string"==typeof e.name&&"string"==typeof e.type}function Dt(e){return Ft(e)||Ut(e)||Bt(e)}function Ut(e){const t=Math.min(20,e.length);if(!(t>0))return!1;let n,r=!1;for(let a=0;a<t;++a){const t=e[a];if(null==t)continue;const i=typeof t;if(void 0===n)switch(i){case"number":case"boolean":case"string":case"bigint":n=i;break;default:return!1}else if(i!==n)return!1;r=!0}return r}function Bt(e){const t=Math.min(20,e.length);if(!(t>0))return!1;let n=!1;for(let r=0;r<t;++r){const t=e[r];if(null!=t){if(!(t instanceof Date))return!1;n=!0}}return n}function Ft(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}Object.defineProperty(jt.prototype,"dialect",{value:"duckdb"});const zt=Object.assign((async(e,t,n,r)=>{if(e=await Ht(await e,r),(a=e)&&("function"==typeof a.sql||"function"==typeof a.queryTag&&("function"==typeof a.query||"function"==typeof a.queryStream))&&("table"!==i||"function"==typeof a.describeColumns)&&a!==zt)return Yt(e,function(e,t){const n="function"==typeof t.escape?t.escape:e=>e,{select:r,from:a,filter:i,sort:o,slice:s}=e;if(!a.table)throw new Error("missing from table");if(r.columns&&0===r.columns.length)throw new Error("at least one column must be selected");const c=new Map(e.names?.map((({column:e,name:t})=>[e,t]))),l=[[`SELECT ${r.columns?r.columns.map((e=>{const t=c.get(e);return t?`${n(e)} AS ${n(t)}`:n(e)})).join(", "):"*"} FROM ${Zt(a.table,n)}`]];for(let u=0;u<i.length;++u)Kt(u?"\nAND ":"\nWHERE ",l),Jt(i[u],l,n);for(let u=0;u<o.length;++u)Kt(u?", ":"\nORDER BY ",l),Xt(o[u],l,n);if("mssql"===t.dialect||"oracle"===t.dialect){if(null!==s.to||null!==s.from){if(!o.length){if(!r.columns)throw new Error("at least one column must be explicitly specified. Received '*'.");Kt("\nORDER BY ",l),Xt({column:r.columns[0],direction:"ASC"},l,n)}Kt(`\nOFFSET ${s.from||0} ROWS`,l),Kt(`\nFETCH NEXT ${null!==s.to?s.to-(s.from||0):1e9} ROWS ONLY`,l)}}else null===s.to&&null===s.from||Kt("\nLIMIT "+(null!==s.to?s.to-(s.from||0):1e9),l),null!==s.from&&Kt(` OFFSET ${s.from}`,l);return l}(t,e),n);var a,i;if(Lt(e))return function(e,t){const n=e;let{columns:r}=e,{schema:a,inferred:i}=function(e){const{columns:t}=e;let{schema:n}=e;return It(n)?{schema:n,inferred:!1}:(n=yn(e,Pt(t)?t:void 0),{schema:n,inferred:!0})}(e);const o=new Map(a.map((({name:e,type:t})=>[e,t])));if(t.types){for(const{name:e,type:r}of t.types){o.set(e,r),a===n.schema&&(a=a.slice());const t=a.findIndex((t=>t.name===e));t>-1&&(a[t]={...a[t],type:r})}e=e.map((e=>vn(e,o,a)))}else i&&(e=e.map((e=>vn(e,o,a))));for(const{type:l,operands:u}of t.filter){const[{value:t}]=u,n=u.slice(1).map((({value:e})=>e));switch(l){case"v":{const[r]=n,a=pn(r);e=e.filter((e=>a(e[t])));break}case"nv":{const[r]=n,a=pn(r);e=e.filter((e=>!a(e[t])));break}case"eq":{const[r]=n;if(r instanceof Date){const n=+r;e=e.filter((e=>+e[t]===n))}else e=e.filter((e=>e[t]===r));break}case"ne":{const[r]=n;e=e.filter((e=>e[t]!==r));break}case"c":{const[r]=n;e=e.filter((e=>"string"==typeof e[t]&&e[t].includes(r)));break}case"nc":{const[r]=n;e=e.filter((e=>"string"==typeof e[t]&&!e[t].includes(r)));break}case"in":{const r=new Set(n);e=e.filter((e=>r.has(e[t])));break}case"nin":{const r=new Set(n);e=e.filter((e=>!r.has(e[t])));break}case"n":e=e.filter((e=>null==e[t]));break;case"nn":e=e.filter((e=>null!=e[t]));break;case"lt":{const[r]=n;e=e.filter((e=>e[t]<r));break}case"lte":{const[r]=n;e=e.filter((e=>e[t]<=r));break}case"gt":{const[r]=n;e=e.filter((e=>e[t]>r));break}case"gte":{const[r]=n;e=e.filter((e=>e[t]>=r));break}default:throw new Error(`unknown filter type: ${l}`)}}for(const{column:l,direction:u}of function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()}(t.sort)){const t="desc"===u?nn:tn;e===n&&(e=e.slice()),e.sort(((e,n)=>t(e[l],n[l])))}let{from:s,to:c}=t.slice;if(s=null==s?0:Math.max(0,s),c=null==c?1/0:Math.max(0,c),(s>0||c<1/0)&&(e=e.slice(Math.max(0,s),Math.max(0,c))),t.select.columns){if(a){const e=new Map(a.map((e=>[e.name,e])));a=t.select.columns.map((t=>e.get(t)))}r&&(r=t.select.columns),e=e.map((e=>Object.fromEntries(t.select.columns.map((t=>[t,e[t]])))))}if(t.names){const n=new Map(t.names.map((e=>[e.column,e])));a&&(a=a.map((e=>{const t=n.get(e.name);return{...e,...t?{name:t.name}:null}}))),r&&(r=r.map((e=>n.get(e)?.name??e))),e=e.map((e=>Object.fromEntries(Object.keys(e).map((t=>[n.get(t)?.name??t,e[t]])))))}return e!==n&&(a&&(e.schema=a),r&&(e.columns=r)),e}(e,t);if(!e)throw new Error("missing data source");throw new Error("invalid data source")}),{sql:(e,t,n)=>async function(){return Yt(await Gt(await e,n),arguments,t)}});function Wt(e){const t=new WeakMap;return(n,r)=>{if(!n)throw new Error("data source not found");let a=t.get(n);return(!a||Lt(n)&&n.length!==a._numRows)&&(a=e(n,r),a._numRows=n.length,t.set(n,a)),a}}const Ht=Wt((async(e,t)=>{if(e instanceof Tn){switch(e.mimeType){case"text/csv":return e.csv();case"text/tab-separated-values":return e.tsv();case"application/json":return e.json();case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return Vt(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return At(e)||Nt(e)?Vt(e,t):Lt(e)&&Dt(e)?Array.from(e,(e=>({value:e}))):e})),Gt=Wt((async(e,t)=>{if(e instanceof Tn){switch(e.mimeType){case"text/csv":case"text/tab-separated-values":case"application/json":return Vt(e,t);case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return Vt(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return Lt(e)?Vt(await async function(e,t){const n=await St();return Dt(e)?n.tableFromArrays({[t]:e}):n.tableFromJSON(e)}(e,t),t):At(e)||Nt(e)?Vt(e,t):e}));function Vt(e,t=(e instanceof Tn?function(e){return e.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"")}(e):"__table")){return jt.of({[t]:e})}async function Yt(e,t,n){if(!e)throw new Error("missing data source");if("function"==typeof e.queryTag){const r=new AbortController,a={signal:r.signal};if(n.then((()=>r.abort("invalidated"))),"function"==typeof e.queryStream)return async function*(e){let t=performance.now();const n=await e,r=[];r.done=!1,r.error=null,r.schema=n.schema;try{for await(const e of n.readRows()){performance.now()-t>150&&r.length>0&&(yield r,t=performance.now());for(const t of e)r.push(t)}r.done=!0,yield r}catch(e){r.error=e,yield r}}(e.queryStream(...e.queryTag.apply(e,t),a));if("function"==typeof e.query)return e.query(...e.queryTag.apply(e,t),a)}if("function"==typeof e.sql)return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}function Zt(e,t){if("object"==typeof e){let n="";return null!=e.database&&(n+=t(e.database)+"."),null!=e.schema&&(n+=t(e.schema)+"."),n+=t(e.table),n}return t(e)}function Kt(e,t){const n=t[0];n[n.length-1]+=e}function Xt({column:e,direction:t},n,r){Kt(`${r(e)} ${t.toUpperCase()}`,n)}function Jt({type:e,operands:t},n,r){if(t.length<1)throw new Error("Invalid operand length");if(1===t.length||"v"===e||"nv"===e)switch(Qt(t[0],n,r),e){case"n":case"nv":return void Kt(" IS NULL",n);case"nn":case"v":return void Kt(" IS NOT NULL",n);default:throw new Error("Invalid filter operation")}if(2!==t.length||["in","nin"].includes(e)){var a;switch(Qt(t[0],n,r),e){case"in":Kt(" IN (",n);break;case"nin":Kt(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}!function(e,t){let n=!0;for(const r of e)n?n=!1:Kt(",",t),t.push(r.value),t[0].push("")}(t.slice(1),n),Kt(")",n)}else{if(["c","nc"].includes(e)){switch(Qt(t[0],n,r),e){case"c":Kt(" LIKE ",n);break;case"nc":Kt(" NOT LIKE ",n)}return void Qt((a=t[1],{...a,value:`%${a.value}%`}),n,r)}switch(Qt(t[0],n,r),e){case"eq":Kt(" = ",n);break;case"ne":Kt(" <> ",n);break;case"gt":Kt(" > ",n);break;case"lt":Kt(" < ",n);break;case"gte":Kt(" >= ",n);break;case"lte":Kt(" <= ",n);break;default:throw new Error("Invalid filter operation")}Qt(t[1],n,r)}}function Qt(e,t,n){"column"===e.type?Kt(n(e.value),t):(t.push(e.value),t[0].push(""))}function en(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))}function tn(e,t){return en(e,t)||(e<t?-1:e>t?1:0)}function nn(e,t){return en(e,t)||(e>t?-1:e<t?1:0)}const rn=e=>"number"==typeof e&&!Number.isNaN(e),an=e=>Number.isInteger(e)&&!Number.isNaN(e),on=e=>"string"==typeof e,sn=e=>"boolean"==typeof e,cn=e=>"bigint"==typeof e,ln=e=>e instanceof Date&&!isNaN(e),un=e=>e instanceof ArrayBuffer,dn=e=>Array.isArray(e),fn=e=>"object"==typeof e&&null!==e,hn=e=>null!=e;function pn(e){switch(e){case"string":return on;case"bigint":return cn;case"boolean":return sn;case"number":return rn;case"integer":return an;case"date":return ln;case"buffer":return un;case"array":return dn;case"object":return fn;default:return hn}}const mn=/^(([-+]\d{2})?\d{4}(-\d{2}(-\d{2}))|(\d{1,2})\/(\d{1,2})\/(\d{2,4}))([T ]\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function bn(e,t){switch(t){case"string":return"string"==typeof e||null==e?e:String(e);case"boolean":if("string"==typeof e){const t=e.trim().toLowerCase();return"true"===t||"false"!==t&&null}return"boolean"==typeof e||null==e?e:Boolean(e);case"bigint":return"bigint"==typeof e||null==e?e:Number.isInteger("string"!=typeof e||e.trim()?+e:NaN)?BigInt(e):void 0;case"integer":case"number":return"number"==typeof e?e:null==e||"string"==typeof e&&!e.trim()?NaN:Number(e);case"date":{if(e instanceof Date||null==e)return e;if("number"==typeof e)return new Date(e);const t=String(e).trim();return"string"!=typeof e||t?new Date(mn.test(t)?t:NaN):null}case"array":case"object":case"buffer":case"other":return e;default:throw new Error(`Unable to coerce to type: ${t}`)}}function vn(e,t,n){const r={};for(const a of n){const n=t.get(a.name),i=e[a.name];r[a.name]="raw"===n?i:bn(i,n)}return r}const wn=["boolean","integer","number","date","bigint","array","object","buffer"];function yn(e,t=function(e){const t=new Set;for(const n of e)if(n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t.add(e);return Array.from(t)}(e)){const n=[],r=e.slice(0,100);for(const a of t){const e={boolean:0,integer:0,number:0,date:0,string:0,array:0,object:0,bigint:0,buffer:0,defined:0};for(const n of r){let t=n[a];if(null==t)continue;const r=typeof t;if("string"!==r)++e.defined,Array.isArray(t)?++e.array:t instanceof Date?++e.date:t instanceof ArrayBuffer?++e.buffer:"number"===r?(++e.number,Number.isInteger(t)&&++e.integer):r in e&&++e[r];else{if(t=t.trim(),!t)continue;++e.defined,++e.string,/^(true|false)$/i.test(t)?++e.boolean:t&&!isNaN(t)?(++e.number,Number.isInteger(+t)&&++e.integer):mn.test(t)&&++e.date}}const t=Math.max(1,.9*e.defined),i=Ct(wn,(n=>e[n]>=t?e[n]:NaN))??(e.string>=t?"string":"other");n.push({name:a,type:i,inferred:i})}return n}class _n{constructor(e){Object.defineProperties(this,{_:{value:e},sheetNames:{value:e.worksheets.map((e=>e.name)),enumerable:!0}})}sheet(e,t){const n="number"==typeof e?this.sheetNames[e]:this.sheetNames.includes(e+="")?e:null;if(null==n)throw new Error(`Sheet not found: ${e}`);return function(e,{range:t,headers:n}={}){let[[r,a],[i,o]]=function(e=":",{columnCount:t,rowCount:n}){if(!(e+="").match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[r=0,a=0],[i=t-1,o=n-1]]=e.split(":").map(Cn);return[[r,a],[i,o]]}(t,e);const s=n?e._rows[a++]:null;let c=new Set(["#"]);for(let u=r;u<=i;u++){const e=s?gn(s.findCell(u+1)):null;let t=e&&e+""||xn(u);for(;c.has(t);)t+="_";c.add(t)}c=new Array(r).concat(Array.from(c));const l=new Array(o-a+1);for(let u=a;u<=o;u++){const t=l[u-a]=Object.create(null,{"#":{value:u+1}}),n=e.getRow(u+1);if(n.hasValues)for(let e=r;e<=i;e++){const r=gn(n.findCell(e+1));null!=r&&(t[c[e+1]]=r)}}return l.columns=c.filter((()=>!0)),l}(this._.getWorksheet(n),t)}}function gn(e){if(!e)return;const{value:t}=e;if(t&&"object"==typeof t&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return En(t);if(t.text){let{text:e}=t;return e.richText&&(e=En(e)),t.hyperlink&&t.hyperlink!==e?`${t.hyperlink} ${e}`:e}return t}return t}function En(e){return e.richText.map((e=>e.text)).join("")}function xn(e){let t="";e++;do{t=String.fromCharCode(64+(e%26||26))+t}while(e=Math.floor((e-1)/26));return t}function Cn(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let r=0;if(t)for(let a=0;a<t.length;a++)r+=Math.pow(26,t.length-a-1)*(t.charCodeAt(a)-64);return[r?r-1:void 0,n?+n-1:void 0]}async function Nn(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}async function An(e,t,{array:n=!1,typed:r=!1}={}){const a=await e.text(),i="\t"===t?n?Ce:xe:n?ge:_e;if("auto"===r&&!n){const e=i(a);return function(e,t){const n=new Map(t.map((({name:e,type:t})=>[e,t])));return Object.assign(e.map((e=>vn(e,n,t))),{schema:t})}(e,yn(e,e.columns))}return i(a,r&&Ne)}class kn{constructor(e,t){Object.defineProperty(this,"name",{value:e,enumerable:!0}),void 0!==t&&Object.defineProperty(this,"mimeType",{value:t+"",enumerable:!0})}async blob(){return(await Nn(this)).blob()}async arrayBuffer(){return(await Nn(this)).arrayBuffer()}async text(){return(await Nn(this)).text()}async json(){return(await Nn(this)).json()}async stream(){return(await Nn(this)).body}async csv(e){return An(this,",",e)}async tsv(e){return An(this,"\t",e)}async image(e){const t=await this.url();return new Promise(((n,r)=>{const a=new Image;new URL(t,document.baseURI).origin!==new URL(location).origin&&(a.crossOrigin="anonymous"),Object.assign(a,e),a.onload=()=>n(a),a.onerror=()=>r(new Error(`Unable to load file: ${this.name}`)),a.src=t}))}async arrow({version:e=4}={}){switch(e){case 4:{const[e,t]=await Promise.all([bt(Fe.resolve()),Nn(this)]);return e.Table.from(t)}case 9:{const[e,t]=await Promise.all([n(7512)(`${pt}${ze.resolve()}`),Nn(this)]);return e.tableFromIPC(t)}case 11:{const[e,t]=await Promise.all([n(7512)(`${pt}${We.resolve()}`),Nn(this)]);return e.tableFromIPC(t)}default:throw new Error(`unsupported arrow version: ${e}`)}}async sqlite(){return wt.open(Nn(this))}async zip(){const[e,t]=await Promise.all([bt(Ie.resolve()),this.arrayBuffer()]);return new jn(await e.loadAsync(t))}async xml(e="application/xml"){return(new DOMParser).parseFromString(await this.text(),e)}async html(){return this.xml("text/html")}async xlsx(){const[e,t]=await Promise.all([bt(Ve.resolve()),this.arrayBuffer()]);return new _n(await(new e.Workbook).xlsx.load(t))}}class Tn extends kn{constructor(e,t,n){super(t,n),Object.defineProperty(this,"_url",{value:e})}async url(){return await this._url+""}}function Sn(e){throw new Error(`File not found: ${e}`)}class jn{constructor(e){Object.defineProperty(this,"_",{value:e}),this.filenames=Object.keys(e.files).filter((t=>!e.files[t].dir))}file(e){const t=this._.file(e+="");if(!t||t.dir)throw new Error(`file not found: ${e}`);return new Mn(t)}}class Mn extends kn{constructor(e){super(e.name),Object.defineProperty(this,"_",{value:e}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}var $n={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},On=0;function qn(e){return new Ln("O-"+(null==e?"":e+"-")+ ++On)}function Ln(e){this.id=e,this.href=new URL(`#${e}`,location)+""}Ln.prototype.toString=function(){return"url("+this.href+")"};var In=Object.freeze({__proto__:null,canvas:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n},context2d:function(e,t,n){null==n&&(n=devicePixelRatio);var r=document.createElement("canvas");r.width=e*n,r.height=t*n,r.style.width=e+"px";var a=r.getContext("2d");return a.scale(n,n),a},download:function(e,t="untitled",n="Save"){const r=document.createElement("a"),a=r.appendChild(document.createElement("button"));async function i(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(r.href),r.removeAttribute("href"),a.textContent=n,a.disabled=!1}return a.textContent=n,r.download=t,r.onclick=async t=>{if(a.disabled=!0,r.href)return i();a.textContent="Saving…";try{const t=await("function"==typeof e?e():e);a.textContent="Download",r.href=URL.createObjectURL(t)}catch(e){a.textContent=n}if(t.eventPhase)return i();a.disabled=!1},r},element:function(e,t){var n,r=e+="",a=r.indexOf(":");a>=0&&"xmlns"!==(r=e.slice(0,a))&&(e=e.slice(a+1));var i=$n.hasOwnProperty(r)?document.createElementNS($n[r],e):document.createElement(e);if(t)for(var o in t)a=(r=o).indexOf(":"),n=t[o],a>=0&&"xmlns"!==(r=o.slice(0,a))&&(o=o.slice(a+1)),$n.hasOwnProperty(r)?i.setAttributeNS($n[r],o,n):i.setAttribute(o,n);return i},input:function(e){var t=document.createElement("input");return null!=e&&(t.type=e),t},range:function(e,t,n){1===arguments.length&&(t=e,e=null);var r=document.createElement("input");return r.min=e=null==e?0:+e,r.max=t=null==t?1:+t,r.step=null==n?"any":n=+n,r.type="range",r},select:function(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,(function(e){var n=document.createElement("option");n.value=n.textContent=e,t.appendChild(n)})),t},svg:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n},text:function(e){return document.createTextNode(e)},uid:qn}),Pn=Object.freeze({__proto__:null,buffer:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)}))},text:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)}))},url:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)}))}});function Rn(){return this}function Dn(e,t){let n=!1;if("function"!=typeof t)throw new Error("dispose is not a function");return{[Symbol.iterator]:Rn,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}function Un(e){let t,n,r=!1;const a=e((function(e){return n?(n(e),n=null):r=!0,t=e}));if(null!=a&&"function"!=typeof a)throw new Error("function"==typeof a.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Rn,throw:()=>({done:!0}),return:()=>(null!=a&&a(),{done:!0}),next:function(){return{done:!1,value:r?(r=!1,Promise.resolve(t)):new Promise((e=>n=e))}}}}function Bn(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,(e=>e.value));default:return e.value}}var Fn=Object.freeze({__proto__:null,disposable:Dn,filter:function*(e,t){for(var n,r=-1;!(n=e.next()).done;)t(n.value,++r)&&(yield n.value)},input:function(e){return Un((function(t){var n=function(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}(e),r=Bn(e);function a(){t(Bn(e))}return e.addEventListener(n,a),void 0!==r&&t(r),function(){e.removeEventListener(n,a)}}))},map:function*(e,t){for(var n,r=-1;!(n=e.next()).done;)yield t(n.value,++r)},observe:Un,queue:function(e){let t;const n=[],r=e((function(e){return n.push(e),t&&(t(n.shift()),t=null),e}));if(null!=r&&"function"!=typeof r)throw new Error("function"==typeof r.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Rn,throw:()=>({done:!0}),return:()=>(null!=r&&r(),{done:!0}),next:function(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise((e=>t=e))}}}},range:function*(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n));++r<a;)yield e+r*n},valueAt:function(e,t){if(!(!isFinite(t=+t)||t<0||t!=t|0))for(var n,r=-1;!(n=e.next()).done;)if(++r===t)return n.value},worker:function(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return Dn(n,(()=>{n.terminate(),URL.revokeObjectURL(t)}))}});function zn(e,t){return function(n){var r,a,i,o,s,c,l,u,d=n[0],f=[],h=null,p=-1;for(s=1,c=arguments.length;s<c;++s){if((r=arguments[s])instanceof Node)f[++p]=r,d+="\x3c!--o:"+p+"--\x3e";else if(Array.isArray(r)){for(l=0,u=r.length;l<u;++l)(a=r[l])instanceof Node?(null===h&&(f[++p]=h=document.createDocumentFragment(),d+="\x3c!--o:"+p+"--\x3e"),h.appendChild(a)):(h=null,d+=a);h=null}else d+=r;d+=n[s]}if(h=e(d),++p>0){for(i=new Array(p),o=document.createTreeWalker(h,NodeFilter.SHOW_COMMENT,null,!1);o.nextNode();)a=o.currentNode,/^o:/.test(a.nodeValue)&&(i[+a.nodeValue.slice(2)]=a);for(s=0;s<p;++s)(a=i[s])&&a.parentNode.replaceChild(f[s],a)}return 1===h.childNodes.length?h.removeChild(h.firstChild):11===h.nodeType?((a=t()).appendChild(h),a):h}}const Wn=zn((function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)}),(function(){return document.createElement("span")}));function Hn(e){let t;Object.defineProperties(this,{generator:{value:Un((e=>{t=e}))},value:{get:()=>e,set:n=>t(e=n)}}),void 0!==e&&t(e)}function*Gn(){for(;;)yield Date.now()}var Vn=new Map;function Yn(e,t){var n;return(n=Vn.get(e=+e))?n.then((()=>t)):(n=Date.now())>=e?Promise.resolve(t):function(e,t){var n=new Promise((function(n){Vn.delete(t);var r=t-e;if(!(r>0))throw new Error("invalid time");if(r>2147483647)throw new Error("too long to wait");setTimeout(n,r)}));return Vn.set(t,n),n}(n,e).then((()=>t))}var Zn=Object.freeze({__proto__:null,delay:function(e,t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))},tick:function(e,t){return Yn(Math.ceil((Date.now()+1)/e)*e,t)},when:Yn});function Kn(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,null==t?location:t).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}const Xn=zn((function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t}),(function(){return document.createElementNS("http://www.w3.org/2000/svg","g")}));var Jn=String.raw;function Qn(e){return new Promise((function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=n,r.onload=t,document.head.appendChild(r)}))}function er(){return Un((function(e){var t=e(document.body.clientWidth);function n(){var n=document.body.clientWidth;n!==t&&e(t=n)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}))}const tr=Object.assign(Object.defineProperties((function(e){const t=function(e){return null==e?bt:lt(e)}(e);var n;Object.defineProperties(this,(n={FileAttachment:()=>Sn,Mutable:()=>Hn,now:Gn,width:er,dot:()=>t(Me.resolve()),htl:()=>t(Le.resolve()),html:()=>Wn,md:()=>function(e){return e(Pe.resolve()).then((function(t){return zn((function(n){var r=document.createElement("div");r.innerHTML=t(n,{langPrefix:""}).trim();var a=r.querySelectorAll("pre code[class]");return a.length>0&&e($e.resolve()).then((function(t){a.forEach((function(n){function r(){t.highlightBlock(n),n.parentNode.classList.add("observablehq--md-pre")}t.getLanguage(n.className)?r():e($e.resolve("async-languages/index.js")).then((r=>{if(r.has(n.className))return e($e.resolve("async-languages/"+r.get(n.className))).then((e=>{t.registerLanguage(n.className,e)}))})).then(r,r)}))})),r}),(function(){return document.createElement("div")}))}))}(t),svg:()=>Xn,tex:()=>function(e){return Promise.all([e(Oe.resolve()),e.resolve(Oe.resolve("dist/katex.min.css")).then(Qn)]).then((function(e){var t=e[0],n=r();function r(e){return function(){var n=document.createElement("div");return t.render(Jn.apply(String,arguments),n,e),n.removeChild(n.firstChild)}}return n.options=r,n.block=r({displayMode:!0}),n}))}(t),_:()=>t(qe.resolve()),aq:()=>t.alias({"apache-arrow":Fe.resolve()})(He.resolve()),Arrow:()=>t(Fe.resolve()),d3:()=>t(Te.resolve()),DuckDBClient:()=>jt,Inputs:()=>t(Se.resolve()).then((e=>({...e,file:e.fileOf(kn)}))),L:()=>async function(e){const t=await e(Ze.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(Ze.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}(t),mermaid:()=>async function(e){const t=await e(Ye.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const e=document.createElement("div");return e.innerHTML=t.render(qn().id,String.raw.apply(String,arguments)),e.removeChild(e.firstChild)}}(t),Plot:()=>t(je.resolve()),__query:()=>zt,require:()=>t,resolve:()=>Kn,SQLite:()=>vt(t),SQLiteDatabaseClient:()=>wt,topojson:()=>t(Ge.resolve()),vl:()=>async function(e){const[t,n,r]=await Promise.all([De,Ue,Be].map((t=>e(t.resolve()))));return r.register(t,n)}(t),aapl:()=>new Tn("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new Tn("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new Tn("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new Tn("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new Tn("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new Tn("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new Tn("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new Tn("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new Tn("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new Tn("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),weather:()=>new Tn("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:In,Files:Pn,Generators:Fn,Promises:Zn},Object.fromEntries(Object.entries(n).map(nr))))}),{resolve:{get:()=>bt.resolve,enumerable:!0,configurable:!0},require:{get:()=>bt,set:function(e){bt=e},enumerable:!0,configurable:!0}}),{resolveFrom:st,requireFrom:lt});function nr([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}class rr extends Error{constructor(e,t){super(e),this.input=t}}function ar(e){return()=>e}function ir(e){return e}rr.prototype.name="RuntimeError";const or=Array.prototype.map;function sr(){}const cr=Symbol("no-observer");function lr(e,t,n){var r;n||(n=cr),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:fr,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:sr,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==cr,writable:!0},_rejector:{value:(r=this,e=>{if(e===hr)throw e;if(e===fr)throw new rr(`${r._name} is not defined`,r._name);if(e instanceof Error&&e.message)throw new rr(e.message,r._name);throw new rr(`${r._name} could not be resolved`,r._name)})},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}function ur(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function dr(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function fr(){throw fr}function hr(){throw hr}function pr(e){return()=>{throw new rr(`${e} is defined more than once`)}}function mr(e,t,n){const r=this._module._scope,a=this._module._runtime;if(this._inputs.forEach(dr,this),t.forEach(ur,this),this._inputs=t,this._definition=n,this._value=void 0,n===sr?a._variables.delete(this):a._variables.add(this),e!==this._name||r.get(e)!==this){let t,i;if(this._name)if(this._outputs.size)r.delete(this._name),i=this._module._resolve(this._name),i._outputs=this._outputs,this._outputs=new Set,i._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(this)]=i}),this),i._outputs.forEach(a._updates.add,a._updates),a._dirty.add(i).add(this),r.set(this._name,i);else if((i=r.get(this._name))===this)r.delete(this._name);else{if(3!==i._type)throw new Error;i._duplicates.delete(this),this._duplicate=void 0,1===i._duplicates.size&&(i=i._duplicates.keys().next().value,t=r.get(this._name),i._outputs=t._outputs,t._outputs=new Set,i._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(t)]=i})),i._definition=i._duplicate,i._duplicate=void 0,a._dirty.add(t).add(i),a._updates.add(i),r.set(this._name,i))}if(this._outputs.size)throw new Error;e&&((i=r.get(e))?3===i._type?(this._definition=pr(e),this._duplicate=n,i._duplicates.add(this)):2===i._type?(this._outputs=i._outputs,i._outputs=new Set,this._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(i)]=this}),this),a._dirty.add(i).add(this),r.set(e,this)):(i._duplicate=i._definition,this._duplicate=n,t=new lr(3,this._module),t._name=e,t._definition=this._definition=i._definition=pr(e),t._outputs=i._outputs,i._outputs=new Set,t._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(i)]=t})),t._duplicates=new Set([this,i]),a._dirty.add(i).add(t),a._updates.add(i).add(t),r.set(e,t)):r.set(e,this)),this._name=e}return this._version>0&&++this._version,a._updates.add(this),a._compute(),this}Object.defineProperties(lr.prototype,{_pending:{value:function(){this._observer.pending&&this._observer.pending()},writable:!0,configurable:!0},_fulfilled:{value:function(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)},writable:!0,configurable:!0},_rejected:{value:function(e){this._observer.rejected&&this._observer.rejected(e,this._name)},writable:!0,configurable:!0},define:{value:function(e,t,n){switch(arguments.length){case 1:n=e,e=t=null;break;case 2:n=t,"string"==typeof e?t=null:(t=e,e=null)}return mr.call(this,null==e?null:String(e),null==t?[]:or.call(t,this._module._resolve,this._module),"function"==typeof n?n:ar(n))},writable:!0,configurable:!0},delete:{value:function(){return mr.call(this,null,[],sr)},writable:!0,configurable:!0},import:{value:function(e,t,n){return arguments.length<3&&(n=t,t=e),mr.call(this,String(t),[n._resolve(String(e))],ir)},writable:!0,configurable:!0}});const br=Symbol("variable"),vr=Symbol("invalidation"),wr=Symbol("visibility");function yr(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",br],["invalidation",vr],["visibility",wr],...t])},_source:{value:null,writable:!0}})}async function _r(e,t){await e._compute();try{return await t._promise}catch(i){if(i===hr)return _r(e,t);throw i}}function gr(e){return e._name}Object.defineProperties(yr.prototype,{_resolve:{value:function(e){let t,n=this._scope.get(e);if(!n)if(n=new lr(2,this),this._builtins.has(e))n.define(e,ar(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))n.import(e,this._runtime._builtin);else{try{t=this._runtime._global(e)}catch(t){return n.define(e,function(e){return()=>{throw e}}(t))}void 0===t?this._scope.set(n._name=e,n):n.define(e,ar(t))}return n},writable:!0,configurable:!0},redefine:{value:function(e){const t=this._scope.get(e);if(!t)throw new rr(`${e} is not defined`);if(3===t._type)throw new rr(`${e} is defined more than once`);return t.define.apply(t,arguments)},writable:!0,configurable:!0},define:{value:function(){const e=new lr(1,this);return e.define.apply(e,arguments)},writable:!0,configurable:!0},derive:{value:function(e,t){const n=new Map,r=new Set,a=[];function i(e){let t=n.get(e);return t||(t=new yr(e._runtime,e._builtins),t._source=e,n.set(e,t),a.push([t,e]),r.add(e),t)}const o=i(this);for(const s of e){const{alias:e,name:n}="object"==typeof s?s:{name:s};o.import(n,null==e?n:e,t)}for(const s of r)for(const[e,t]of s._scope)if(t._definition===ir){if(s===this&&o._scope.has(e))continue;const n=t._inputs[0]._module;n._source&&i(n)}for(const[s,c]of a)for(const[e,t]of c._scope){const r=s._scope.get(e);if(!r||2===r._type)if(t._definition===ir){const r=t._inputs[0],a=r._module;s.import(r._name,e,n.get(a)||a)}else s.define(e,t._inputs.map(gr),t._definition)}return o},writable:!0,configurable:!0},import:{value:function(){const e=new lr(1,this);return e.import.apply(e,arguments)},writable:!0,configurable:!0},value:{value:async function(e){let t=this._scope.get(e);if(!t)throw new rr(`${e} is not defined`);if(t._observer!==cr)return _r(this._runtime,t);t=this.variable(!0).define([e],ir);try{return await _r(this._runtime,t)}finally{t.delete()}},writable:!0,configurable:!0},variable:{value:function(e){return new lr(1,this,e)},writable:!0,configurable:!0},builtin:{value:function(e,t){this._builtins.set(e,t)},writable:!0,configurable:!0}});const Er="function"==typeof requestAnimationFrame?requestAnimationFrame:"function"==typeof setImmediate?setImmediate:e=>setTimeout(e,0);function xr(e=new tr,t=$r){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(const r in e)new lr(2,n).define(r,[],e[r])}function Cr(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function Nr(e){++e._indegree}function Ar(e){--e._indegree}function kr(e){return e._promise.catch(e._rejector)}function Tr(e){return new Promise((function(t){e._invalidate=t}))}function Sr(e,t){let n,r,a="function"==typeof IntersectionObserver&&t._observer&&t._observer._node,i=!a,o=sr,s=sr;return a&&(r=new IntersectionObserver((([e])=>(i=e.isIntersecting)&&(n=null,o()))),r.observe(a),e.then((()=>(r.disconnect(),r=null,s())))),function(e){return i?Promise.resolve(e):r?(n||(n=new Promise(((e,t)=>(o=e,s=t)))),n.then((()=>e))):Promise.reject()}}function jr(e){e._invalidate(),e._invalidate=sr,e._pending();const t=e._value,n=++e._version;let r=null;const a=e._promise=(e._inputs.length?Promise.all(e._inputs.map(kr)).then((function(a){if(e._version!==n)throw hr;for(let t=0,n=a.length;t<n;++t)switch(a[t]){case vr:a[t]=r=Tr(e);break;case wr:r||(r=Tr(e)),a[t]=Sr(r,e);break;case br:a[t]=e}return e._definition.apply(t,a)})):new Promise((n=>n(e._definition.call(t))))).then((function(t){if(e._version!==n)throw hr;return function(e){return e&&"function"==typeof e.next&&"function"==typeof e.return}(t)?((r||Tr(e)).then((a=t,function(){a.return()})),function(e,t,n){const r=e._module._runtime;let a;function i(e){return new Promise((e=>e(n.next(a)))).then((({done:t,value:n})=>t?void 0:Promise.resolve(n).then(e)))}function o(){const n=i((i=>{if(e._version!==t)throw hr;return a=i,s(i,n).then((()=>r._precompute(o))),e._fulfilled(i),i}));n.catch((r=>{r!==hr&&e._version===t&&(s(void 0,n),e._rejected(r))}))}function s(t,n){return e._value=t,e._promise=n,e._outputs.forEach(r._updates.add,r._updates),r._compute()}return i((n=>{if(e._version!==t)throw hr;return a=n,r._precompute(o),n}))}(e,n,t)):t;var a}));a.then((t=>{e._value=t,e._fulfilled(t)}),(t=>{t!==hr&&(e._value=void 0,e._rejected(t))}))}function Mr(e,t){e._invalidate(),e._invalidate=sr,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(sr),e._value=void 0,e._rejected(t)}function $r(e){return globalThis[e]}Object.defineProperties(xr.prototype,{_precompute:{value:function(e){this._precomputes.push(e),this._compute()},writable:!0,configurable:!0},_compute:{value:function(){return this._computing||(this._computing=this._computeSoon())},writable:!0,configurable:!0},_computeSoon:{value:function(){return new Promise(Er).then((()=>this._disposed?void 0:this._computeNow()))},writable:!0,configurable:!0},_computeNow:{value:async function(){let e,t,n=[],r=this._precomputes;if(r.length){this._precomputes=[];for(const e of r)e();await function(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then((()=>{}));return t}(3)}e=new Set(this._dirty),e.forEach((function(t){t._inputs.forEach(e.add,e);const n=function(e){if(e._observer!==cr)return!0;const t=new Set(e._outputs);for(const n of t){if(n._observer!==cr)return!0;n._outputs.forEach(t.add,t)}return!1}(t);n>t._reachable?this._updates.add(t):n<t._reachable&&t._invalidate(),t._reachable=n}),this),e=new Set(this._updates),e.forEach((function(t){t._reachable?(t._indegree=0,t._outputs.forEach(e.add,e)):(t._indegree=NaN,e.delete(t))})),this._computing=null,this._updates.clear(),this._dirty.clear(),e.forEach((function(e){e._outputs.forEach(Nr)}));do{for(e.forEach((function(e){0===e._indegree&&n.push(e)}));t=n.pop();)jr(t),t._outputs.forEach(a),e.delete(t);e.forEach((function(t){Cr(t)&&(Mr(t,new rr("circular definition")),t._outputs.forEach(Ar),e.delete(t))}))}while(e.size);function a(e){0==--e._indegree&&n.push(e)}},writable:!0,configurable:!0},dispose:{value:function(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach((e=>{e._invalidate(),e._version=NaN}))},writable:!0,configurable:!0},module:{value:function(e,t=sr){let n;if(void 0===e)return(n=this._init)?(this._init=null,n):new yr(this);if(n=this._modules.get(e),n)return n;this._init=n=new yr(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n},writable:!0,configurable:!0},fileAttachments:{value:function(e){return Object.assign((t=>{const n=e(t+="");if(null==n)throw new Error(`File not found: ${t}`);if("object"==typeof n&&"url"in n){const{url:e,mimeType:r}=n;return new Tn(e,t,r)}return new Tn(n,t)}),{prototype:Tn.prototype})},writable:!0,configurable:!0}})},7512:function(e,t,n){var r={"./inspector.css":[8240,240],"./knowledge_map@1400":[7783],"./knowledge_map@1400.js":[7783],"./runtime":[3357],"./runtime.js":[3357]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=7512,e.exports=a}}]);
//# sourceMappingURL=747.342cca5c.js.map